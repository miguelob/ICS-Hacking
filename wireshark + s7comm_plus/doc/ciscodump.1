.\" Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "CISCODUMP 1"
.TH CISCODUMP 1 "2020-12-18" "3.4.2" "The Wireshark Network Analyzer"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
ciscodump \- Provide interfaces to capture from a remote Cisco router through SSH.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBciscodump\fR
[\ \fB\-\-help\fR\ ]
[\ \fB\-\-version\fR\ ]
[\ \fB\-\-extcap\-interfaces\fR\ ]
[\ \fB\-\-extcap\-dlts\fR\ ]
[\ \fB\-\-extcap\-interface\fR=<interface>\ ]
[\ \fB\-\-extcap\-config\fR\ ]
[\ \fB\-\-extcap\-capture\-filter\fR=<capture\ filter>\ ]
[\ \fB\-\-capture\fR\ ]
[\ \fB\-\-fifo\fR=<path\ to\ file\ or\ pipe>\ ]
[\ \fB\-\-remote\-host\fR=<\s-1IP\s0\ address>\ ]
[\ \fB\-\-remote\-port\fR=<\s-1TCP\s0\ port>\ ]
[\ \fB\-\-remote\-username\fR=<username>\ ]
[\ \fB\-\-remote\-password\fR=<password>\ ]
[\ \fB\-\-remote\-filter\fR=<filter<gt ]>
[\ \fB\-\-sshkey\fR=<public\ key\ path<gt ]>
[\ \fB\-\-remote\-interface\fR=<interface>\ ]
.PP
\&\fBciscodump\fR
\&\fB\-\-extcap\-interfaces\fR
.PP
\&\fBciscodump\fR
\&\fB\-\-extcap\-interface\fR=<interface>
\&\fB\-\-extcap\-dlts\fR
.PP
\&\fBciscodump\fR
\&\fB\-\-extcap\-interface\fR=<interface>
\&\fB\-\-extcap\-config\fR
.PP
\&\fBciscodump\fR
\&\fB\-\-extcap\-interface\fR=<interface>
\&\fB\-\-fifo\fR=<path\ to\ file\ or\ pipe>
\&\fB\-\-capture\fR
\&\fB\-\-remote\-host=remoterouter\fR
\&\fB\-\-remote\-port=22\fR
\&\fB\-\-remote\-username=user\fR
\&\fB\-\-remote\-interface\fR=<the\ router\ interface>
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBCiscodump\fR is an extcap tool that relies on Cisco \s-1EPC\s0 to allow a user to run a remote capture
on a Cisco router in a \s-1SSH\s0 connection. The minimum \s-1IOS\s0 version supporting this feature is 12.4(20)T. More details can be
found here:
https://www.cisco.com/c/en/us/products/collateral/ios\-nx\-os\-software/ios\-embedded\-packet\-capture/datasheet_c78\-502727.html
.PP
Supported interfaces:
.IP "1. cisco" 4
.IX Item "1. cisco"
.SH "OPTIONS"
.IX Header "OPTIONS"
.PD 0
.IP "\-\-help" 4
.IX Item "--help"
.PD
Print program arguments.
.IP "\-\-version" 4
.IX Item "--version"
Print program version.
.IP "\-\-extcap\-interfaces" 4
.IX Item "--extcap-interfaces"
List available interfaces.
.IP "\-\-extcap\-interface=<interface>" 4
.IX Item "--extcap-interface=<interface>"
Use specified interfaces.
.IP "\-\-extcap\-dlts" 4
.IX Item "--extcap-dlts"
List DLTs of specified interface.
.IP "\-\-extcap\-config" 4
.IX Item "--extcap-config"
List configuration options of specified interface.
.IP "\-\-capture" 4
.IX Item "--capture"
Start capturing from specified interface and save it in place specified by \-\-fifo.
.IP "\-\-fifo=<path to file or pipe>" 4
.IX Item "--fifo=<path to file or pipe>"
Save captured packet to file or send it through pipe.
.IP "\-\-remote\-host=<remote host>" 4
.IX Item "--remote-host=<remote host>"
The address of the remote host for capture.
.IP "\-\-remote\-port=<remote port>" 4
.IX Item "--remote-port=<remote port>"
The \s-1SSH\s0 port of the remote host.
.IP "\-\-remote\-username=<username>" 4
.IX Item "--remote-username=<username>"
The username for ssh authentication.
.IP "\-\-remote\-password=<password>" 4
.IX Item "--remote-password=<password>"
The password to use (if not ssh-agent and pubkey are used). \s-1WARNING:\s0 the
passwords are stored in plaintext and visible to all users on this system. It is
recommended to use keyfiles with a \s-1SSH\s0 agent.
.IP "\-\-remote\-filter=<filter>" 4
.IX Item "--remote-filter=<filter>"
The remote filter on the router. This is a capture filter that follows the Cisco
\&\s-1IOS\s0 standards
(https://www.cisco.com/c/en/us/support/docs/ip/access\-lists/26448\-ACLsamples.html).
Multiple filters can be specified using a comma between them. \s-1BEWARE:\s0 when using
a filter, the default behavior is to drop all the packets except the ones that
fall into the filter.
.Sp
Examples:
.Sp
.Vb 1
\&    permit ip host MYHOST any, permit ip any host MYHOST (capture the traffic for MYHOST)
\&
\&    deny ip host MYHOST any, deny ip any host MYHOST, permit ip any any (capture all the traffic except MYHOST)
.Ve
.IP "\-\-sshkey=<\s-1SSH\s0 private key path>" 4
.IX Item "--sshkey=<SSH private key path>"
The path to a private key for authentication.
.IP "\-\-remote\-interface=<remote interface>" 4
.IX Item "--remote-interface=<remote interface>"
The remote network interface to capture from.
.IP "\-\-extcap\-capture\-filter=<capture filter>" 4
.IX Item "--extcap-capture-filter=<capture filter>"
Unused (compatibility only).
.SH "EXAMPLES"
.IX Header "EXAMPLES"
To see program arguments:
.PP
.Vb 1
\&    ciscodump \-\-help
.Ve
.PP
To see program version:
.PP
.Vb 1
\&    ciscodump \-\-version
.Ve
.PP
To see interfaces:
.PP
.Vb 1
\&    ciscodump \-\-extcap\-interfaces
.Ve
.PP
Only one interface (cisco) is supported.
.PP
.Vb 2
\&  Output:
\&    interface {value=cisco}{display=SSH remote capture}
.Ve
.PP
To see interface DLTs:
.PP
.Vb 1
\&    ciscodump \-\-extcap\-interface=cisco \-\-extcap\-dlts
\&
\&  Output:
\&    dlt {number=147}{name=cisco}{display=Remote capture dependent DLT}
.Ve
.PP
To see interface configuration options:
.PP
.Vb 1
\&    ciscodump \-\-extcap\-interface=cisco \-\-extcap\-config
\&
\&  Output:
\&    ciscodump \-\-extcap\-interface=cisco \-\-extcap\-config
\&    arg {number=0}{call=\-\-remote\-host}{display=Remote SSH server address}
\&        {type=string}{tooltip=The remote SSH host. It can be both an IP address or a hostname}
\&        {required=true}
\&    arg {number=1}{call=\-\-remote\-port}{display=Remote SSH server port}{type=unsigned}
\&        {default=22}{tooltip=The remote SSH host port (1\-65535)}{range=1,65535}
\&    arg {number=2}{call=\-\-remote\-username}{display=Remote SSH server username}{type=string}
\&        {default=<current user>}{tooltip=The remote SSH username. If not provided, the current
\&        user will be used}
\&    arg {number=3}{call=\-\-remote\-password}{display=Remote SSH server password}{type=string}
\&        {tooltip=The SSH password, used when other methods (SSH agent or key files) are unavailable.}
\&    arg {number=4}{call=\-\-sshkey}{display=Path to SSH private key}{type=fileselect}
\&        {tooltip=The path on the local filesystem of the private ssh key}
\&    arg {number=5}{call\-\-sshkey\-passphrase}{display=SSH key passphrase}
\&        {type=string}{tooltip=Passphrase to unlock the SSH private key}
\&    arg {number=6}{call=\-\-remote\-interface}{display=Remote interface}{type=string}
\&        {required=true}{tooltip=The remote network interface used for capture}
\&    arg {number=7}{call=\-\-remote\-filter}{display=Remote capture filter}{type=string}
\&        {default=(null)}{tooltip=The remote capture filter}
\&    arg {number=8}{call=\-\-remote\-count}{display=Packets to capture}{type=unsigned}{required=true}
\&        {tooltip=The number of remote packets to capture.}
.Ve
.PP
To capture:
.PP
.Vb 3
\&    ciscodump \-\-extcap\-interface cisco \-\-fifo=/tmp/cisco.pcap \-\-capture \-\-remote\-host 192.168.1.10
\&        \-\-remote\-username user \-\-remote\-interface gigabit0/0
\&        \-\-remote\-filter "permit ip host 192.168.1.1 any, permit ip any host 192.168.1.1"
.Ve
.PP
\&\s-1NOTE:\s0 Packet count is mandatory, hence the capture will start after this number.
.SH "KNOWN ISSUES"
.IX Header "KNOWN ISSUES"
The configuration of the capture on the routers is a multi-step process. If the \s-1SSH\s0 connection is interrupted during
it, the configuration can be in an inconsistent state. That can happen also if the capture is stopped and ciscodump
can't clean the configuration up. In this case it is necessary to log into the router and manually clean the
configuration, removing both the capture point (\s-1WIRESHARK_CAPTURE_POINT\s0), the capture buffer (\s-1WIRESHARK_CAPTURE_BUFFER\s0)
and the capture filter (\s-1WIRESHARK_CAPTURE_FILTER\s0).
.PP
Another known issues is related to the number of captured packets (\-\-remote\-count). Due to the nature of the capture
buffer, ciscodump waits for the capture to complete and then issues the command to show it. It means that if the user
specifies a number of packets above the currently captured, the show command is never shown. Not only is the count of
the maximum number of captured packets, but it is also the _exact_ number of expected packets.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fBwireshark\fR\|(1), \fBtshark\fR\|(1), \fBdumpcap\fR\|(1), \fBextcap\fR\|(4), \fBsshdump\fR\|(1)
.SH "NOTES"
.IX Header "NOTES"
\&\fBciscodump\fR is part of the \fBWireshark\fR distribution.  The latest version
of \fBWireshark\fR can be found at <https://www.wireshark.org>.
.PP
\&\s-1HTML\s0 versions of the Wireshark project man pages are available at:
<https://www.wireshark.org/docs/man\-pages>.
.SH "AUTHORS"
.IX Header "AUTHORS"
.Vb 3
\&  Original Author
\&  \-\-\-\-\-\-\-\- \-\-\-\-\-\-
\&  Dario Lombardo             <lomato[AT]gmail.com>
.Ve
